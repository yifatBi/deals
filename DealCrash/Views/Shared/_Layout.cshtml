<!-- Shalom Moyal: 312413925 -->
<!-- Shay Sheli: 311529838 -->
<!-- Ella Wainrub: 204635155-->
<!-- Eli Leon : 200823862 -->
@{
    DealCrash.Models.User usr = ((DealCrash.Models.User)Session["user"]);
}
<!doctype html>
<html>
<head>
    <title>DealForMe</title>

    <link href="~/Content/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="~/Content/webFirst.css" type="text/css" media="screen" />
    <link href="~/Content/app.css" rel="stylesheet">
</head>
<body>



    <div>
        <div style="display:inline-block">
            <header>
                <h1 class="shadow">DealForMe - Blog</h1>
            </header>
        </div>
        <div class="pull-right">
            <canvas id="analogClock" width="102" height="102">Clock</canvas>
        </div>
    </div>

    <nav class="navbar navbar-inverse">
        <div class="container-fluid">
            <ul class="nav navbar-nav navbar-left">
                @if (usr == null)
                {
                    <li>@Html.ActionLink("הרשמה", "Create", "Users") </li>
                    <li>@Html.ActionLink("התחברות", "LoginToSystem", "Users") </li>
                }
                else
                {
                    <listyle ="font-size: 25px;color: white;">@Html.ActionLink("התנתקות", "Logout", "Users")</listyle>
                    <li style="font-size: 25px;color: white; top: 10px;">ברוכה השבה @(usr.name)</li>
                }
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>@Html.ActionLink("עלינו", "About", "Home")</li>
                <li>@Html.ActionLink("יצירת קשר", "Contact", "Home")</li>

                <li>@Html.ActionLink("מבצעים", "Index", "Deals")</li>

                @if (usr != null)
                {
                    if (usr.admin)
                    {
                        <li>@Html.ActionLink("סטטיסטיקות", "Stats", "Users")</li>
                        <li>@Html.ActionLink("ניהול משתמשים", "Index", "Users")</li>
                        <li>@Html.ActionLink("ניהול תגובות", "Index", "Comments")</li>
                    }
                }

                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        חיפוש
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li>@Html.ActionLink("חיפוש פוסטים", "Search", "Deals")</li>
                        <li>@Html.ActionLink("חיפוש תגובות", "Search", "Comments")</li>
                    </ul>
                </li>



                <li>@Html.ActionLink("העמוד הראשי", "Index", "Deals")</li>



        </div>
    </nav>



    <section id="intro">
        <!-- Introduction -->
        <header>
            <h2>ברוכים הבאים לאתר הדילים הגדול בישראל</h2>
        </header>
        <p>
            מצאתם דיל מטורף ואתם רוצים לשתף אותו עם כל העולם? חיפשתם מבצע משוגע ולא מצאתם אותו כלל? בשביל זה אנחנו פה! העלו את הדילים שאתם רוצים לשתף ותכתבו חוות דעת על דילים אחרים. גלישה נעימה וזולה
        </p>
        <img src="~/image/logo.png" alt="logo" />
    </section>
    <div id="content" class="container body-content">
        <div style="display: -webkit-box;">
            <div id="content">
                <div id="mainContent">
                    <section>
                        @RenderBody()
                    </section>
                </div>
                <aside>
                    <section>
                        <header>
                            <h3>קטגוריות</h3>
                        </header>
                        <ul>
                            <li>@Html.ActionLink("Clothing", "CatClothing", "Deals")</li>
                            <li>@Html.ActionLink("Food", "CatFood", "Deals")</li>
                            <li>@Html.ActionLink("Extreme", "CatExtreme", "Deals")</li>
                        </ul>
                    </section>
                    <section>
                        <header>
                            <h3>וידאו השבוע</h3>
                        </header>
                        <video width="300" controls>
                            <source src="~/Content/Videos/Adele - Hello.mp4" type="video/mp4">
                            Your browser does not support HTML5 video.
                        </video>
                    </section>
                </aside>
            </div>
        </div>
        <footer>
            <div>
                <section id="about">
                    <h3>
                       עלינו
                        <div id="fb-root"></div>
                    </h3>
                    <p>            מצאתם דיל מטורף ואתם רוצים לשתף אותו עם כל העולם? חיפשתם מבצע משוגע ולא מצאתם אותו כלל? בשביל זה אנחנו פה! העלו את הדילים שאתם רוצים לשתף ותכתבו חוות דעת על דילים אחרים. גלישה נעימה וזולה
</p>
                </section>
               
                <section id="popular">
                    <h3>
                        כללי
                    </h3>
                    <ul>
                        <li id="IP">123.123.12.321</li>
                        <li id="Location">Israel</li>
                        <li>
                            <!-- Button trigger modal -->
                            <a data-toggle="modal" data-target="#myModal" style="cursor:pointer; vertical-align:bottom">
                                <img class="hover" src="@Href("~/image/location.png")" width="20" height="20"> Launch map
                            </a>
                        </li>
                    </ul>
                </section>
            </div>
        </footer>
    </div>
    <div>
        <!-- Modal -->
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="myModalLabel">Map</h4>
                    </div>
                    <div class="modal-body">
                        <div class="container">
                            <div class="row">
                                <div id="map-canvas"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>


    <div id="fb-root"></div>
    <script>
        (function(d, s, id) {
          var js, fjs = d.getElementsByTagName(s)[0];
          if (d.getElementById(id)) return;
          js = d.createElement(s); js.id = id;
          js.src = "//connect.facebook.net/he_IL/sdk.js#xfbml=1&version=v2.8&appId=240889989312250";
          fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script>

    <script src="~/Scripts/jquery-1.10.2.min.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script>
        var userLocation, mapCenter, marker;

        $(document).ready(function () {
            $.ajax({
                url: 'http://geoip.nekudo.com/api',
                data: {
                    format: 'json'
                },
                error: setMapLocation,
                dataType: 'jsonp',
                success: function (data) {
                    $("#IP").html("IP address" + data.ip);
                    $("#Location").html(data.country.name);
                    userLocation = data.location;
                    setMapLocation();
                },
                type: 'GET'
            });
        });

        function setMapLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function (position) {
                    mapCenter = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    };
                    initMap();
                }, function () {
                    mapCenter = {
                        lat: userLocation.latitude,
                        lng: userLocation.longitude
                    };
                    initMap();
                });
            } else {
                mapCenter = {
                    lat: userLocation.latitude,
                    lng: userLocation.longitude
                };
                initMap();
            }
        }

        function initMap() {
            var map = new google.maps.Map(document.getElementById('map-canvas'), {
                center: mapCenter,
                scrollwheel: false,
                zoom: 16
            });
            var marker = new google.maps.Marker({
                position: mapCenter
            });

            marker.setMap(map);

            $('#myModal').on('shown.bs.modal', function () {
                setTimeout(function () {
                    google.maps.event.trigger(map, "resize");
                    map.setCenter(mapCenter);
                }, 100);
            });
        }
    </script>

    <script>
        //clock
        setupAnalogClock(document.getElementById("analogClock"), 100);
        function setupAnalogClock(canvas, clockWidth) {
            //		var canvas = document.getElementById("analogClock");
            var ctx = canvas.getContext("2d");
            var centerX = canvas.width / 2;
            var centerY = canvas.height / 2;

            function tick() {
                var date = new Date();
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                drawStatic();

                var hours = date.getHours();
                ctx.strokeStyle = "black";
                ctx.lineWidth = 2;
                drawHand(clockWidth / 3, hours * 30);

                var minutes = date.getMinutes();
                ctx.strokeStyle = "black";
                ctx.lineWidth = 2;
                drawHand(clockWidth / 2, minutes * 6);

                var seconds = date.getSeconds();
                ctx.strokeStyle = "red";
                ctx.lineWidth = 1;
                drawHand(clockWidth / 2, seconds * 6);


                function drawStatic() {
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, clockWidth / 2, 0, 2 * Math.PI, false);
                    ctx.strokeStyle = "black";
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    ctx.closePath();

                    ctx.beginPath();
                    ctx.arc(centerX, centerY, 2, 0, 2 * Math.PI, false);
                    ctx.fillStyle = "black";
                    ctx.fill();
                    ctx.closePath();

                    drawNumbers();

                    function drawNumbers() {
                        var i = 12;
                        ctx.strokeStyle = "black";
                        ctx.lineWidth = 2;
                        while (i > 0) {
                            ctx.save();
                            ctx.beginPath();
                            ctx.translate(centerX, centerY);
                            var angle = (i * 30) * Math.PI / 180;
                            ctx.rotate(angle);
                            ctx.translate(0, -clockWidth / 2);
                            ctx.moveTo(0, 0);
                            ctx.lineTo(0, 10);
                            ctx.stroke();
                            ctx.closePath();
                            ctx.restore();
                            i--;
                        }
                    }
                }

                function drawHand(length, angle) {
                    ctx.save();
                    ctx.beginPath();
                    ctx.translate(centerX, centerY);
                    ctx.rotate(-180 * Math.PI / 180);
                    ctx.rotate(angle * Math.PI / 180);
                    ctx.moveTo(0, 0);
                    ctx.lineTo(0, length);
                    ctx.stroke();
                    ctx.closePath();
                    ctx.restore();
                }
            }

            tick();
            window.setInterval(tick, 1000);
        }
    </script>


    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD3w5YqVudG02c9nKLxd9VvMukC5a6xFUw"
            async defer></script>







</body>
</html>
